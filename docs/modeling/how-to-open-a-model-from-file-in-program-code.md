---
title: 'Cómo: Abrir un modelo desde un archivo en el código del programa'
description: Obtenga información sobre que ModelBus proporciona un mecanismo estándar para hacer referencia a un modelo o elementos de un modelo y para buscar el modelo si se ha movido.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: how-to
author: mgoertz-msft
ms.author: mgoertz
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 97de2d7e79dc44ff785663c4d04dc65851430472
ms.sourcegitcommit: e3a364c014ccdada0860cc4930d428808e20d667
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/19/2021
ms.locfileid: "112387065"
---
# <a name="how-to-open-a-model-from-file-in-program-code"></a>Cómo: Abrir un modelo desde un archivo en el código del programa

Puede abrir modelos DSL en cualquier aplicación.

Desde una Visual Studio, puede usar ModelBus para este propósito. ModelBus proporciona un mecanismo estándar para hacer referencia a un modelo o elementos de un modelo y para buscar el modelo si se ha movido. Para obtener más información, vea [Integración de modelos mediante Visual Studio Modelbus](../modeling/integrating-models-by-using-visual-studio-modelbus.md).

## <a name="target-framework"></a>Marco de destino

Establezca la **plataforma de destino** del proyecto de aplicación en .NET Framework 4 o posterior.

1. Abra el Visual Studio proyecto para la aplicación en la que desea leer un modelo DSL.

2. En **Explorador de soluciones**, haga clic con el botón derecho en el proyecto y, a continuación, haga clic en **Propiedades**.

3. En la ventana de propiedades del proyecto, en la **pestaña** Aplicación, establezca el campo **Marco** de destino **en .NET Framework 4** (o posterior).

> [!NOTE]
> La plataforma de destino no debe .NET Framework **perfil de cliente 4**.

## <a name="references"></a>Referencias

Agregue estas referencias al proyecto Visual Studio aplicación:

- `Microsoft.VisualStudio.Modeling.Sdk.11.0`

  - Si no lo ve en la pestaña **.NET** del cuadro de **diálogo** Agregar referencias, haga clic en la pestaña **Examinar** y vaya a `%Program Files%\Microsoft Visual Studio 2010 SDK\VisualStudioIntegration\Common\Assemblies\` .

- El ensamblado DSL, que encontrará en la carpeta bin, el proyecto DSL. Su nombre suele tener el formato: *YourCompany*. *YourProject* `.Dsl.dll` .

## <a name="important-classes-in-the-dsl"></a>Clases importantes en el DSL

Para poder escribir el código que lee el DSL, debe conocer los nombres de algunas de las clases generadas por el DSL. En la solución DSL, abra el **proyecto Dsl** y busque en la **carpeta GeneratedCode.** Como alternativa, haga doble clic en el ensamblado DSL del proyecto **Referencias** y abra el espacio de nombres DSL en **el Explorador de objetos**.

Estas son las clases que debe identificar:

- *YourDslRootClass:* este es el nombre de la clase raíz en `DslDefinition.dsl` .

- *YourDslName* `SerializationHelper` - Esta clase se define en en `SerializationHelper.cs` el proyecto DSL.

- *YourDslName* `DomainModel` - Esta clase se define en en `DomainModel.cs` el proyecto DSL.

## <a name="read-from-a-file"></a>Leer de un archivo

El ejemplo siguiente está diseñado para leer un DSL en el que las clases importantes son las siguientes:

- FamilyTreeModel

- FamilyTreeSerializationHelper

- FamilyTreeDomainModel

La otra clase de dominio de este DSL es Person.

```csharp
using System;
using Microsoft.VisualStudio.Modeling;
using Company.FamilyTree; // Your DSL namespace

namespace StandaloneReadDslConsole
{ class Program
  { static void Main(string[] args)
    {
      // The path of a DSL model file:
      string dslModel = @"C:\FamilyTrees\Tudor.ftree";
      // Set up the Store to read your type of model:
      Store store = new Store(
        typeof(Company.FamilyTree.FamilyTreeDomainModel));
      // The Model type generated by the DSL:
      FamilyTreeModel familyTree;
      // All Store changes must be in a Transaction:
      using (Transaction t =
        store.TransactionManager.BeginTransaction("Load model"))
      {
        familyTree =
           FamilyTreeSerializationHelper.Instance.
              LoadModel(store, dslModel, null, null, null);
        t.Commit(); // Don't forget this!
      }
      // Now we can read the model:
      foreach (Person p in familyTree.People)
      {
        Console.WriteLine(p.Name);
        foreach (Person child in p.Children)
        {
          Console.WriteLine("    " + child.Name);
        }
} } } }
```

## <a name="save-to-a-file"></a>Guardar en un archivo

La siguiente adición al código anterior realiza un cambio en el modelo y, a continuación, lo guarda en un archivo.

```csharp
using (Transaction t =
  store.TransactionManager.BeginTransaction("update model"))
{
  // Create a new model element:
  Person p = new Person(store);
  // Set its embedding relationship:
  p.FamilyTreeModel = familyTree;
  // - same as: familyTree.People.Add(p);
  // Set its properties:
  p.Name = "Edward VI";
  t.Commit(); // Don't forget this!
}
// Save the model:
try
{
  SerializationResult result = new SerializationResult();
  FamilyTreeSerializationHelper.Instance
    .SaveModel(result, familyTree, @"C:\FamilyTrees\Tudor-upd.ftree");
  // Report any error:
  if (result.Failed)
  {
    foreach (SerializationMessage message in result)
    {
      Console.WriteLine(message);
    }
  }
}
catch (System.IO.IOException ex)
{ ... }
```

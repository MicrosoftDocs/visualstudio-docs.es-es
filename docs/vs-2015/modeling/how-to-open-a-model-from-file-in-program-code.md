---
title: 'Cómo: abrir un modelo desde un archivo en el código del programa | Microsoft Docs'
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-modeling
ms.topic: conceptual
ms.assetid: d7d68697-5418-4263-bdb2-48401924ea71
caps.latest.revision: 10
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: c98bec69631b852521f682a24dd1b5ce6ddf0424
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/19/2019
ms.locfileid: "72662571"
---
# <a name="how-to-open-a-model-from-file-in-program-code"></a>Cómo: Abrir un modelo desde un archivo en el código del programa
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Puede abrir modelos DSL en cualquier aplicación.

 En una extensión de [!INCLUDE[vsprvs](../includes/vsprvs-md.md)], puede usar ModelBus para este propósito. ModelBus proporciona un mecanismo estándar para hacer referencia a un modelo o elementos de un modelo, y para buscar el modelo si se ha deshecho. Para obtener más información, vea [integrar modelos mediante Modelbus de Visual Studio](../modeling/integrating-models-by-using-visual-studio-modelbus.md).

## <a name="target-framework"></a>Versión de .NET Framework de destino
 Establezca la **plataforma de destino** del proyecto de aplicación en **.NET Framework 4**.

#### <a name="to-set-the-target-framework"></a>Para establecer la versión de .NET Framework de destino

1. Abra el proyecto de [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] para la aplicación en la que desea leer un modelo DSL.

2. En **Explorador de soluciones**, haga clic con el botón secundario en el proyecto y, a continuación, haga clic en **propiedades**.

3. En la ventana Propiedades del proyecto, en la pestaña **aplicación** , establezca el campo **plataforma de destino** en **.NET Framework 4**.

> [!NOTE]
> Es posible que tenga que hacerlo incluso si seleccionó **.NET Framework 4** en el cuadro de diálogo de creación del proyecto. La versión de .NET Framework de destino no debe ser **.NET Framework 4 Client Profile**.

## <a name="references"></a>Referencias
 Tiene que agregar estas referencias al proyecto de aplicación de [!INCLUDE[vsprvs](../includes/vsprvs-md.md)]:

- `Microsoft.VisualStudio.Modeling.Sdk.11.0`

  - Si no lo ve en la pestaña **.net** del cuadro de diálogo **Agregar referencias** , haga clic en la pestaña **examinar** y vaya a `%Program Files%\Microsoft Visual Studio 2010 SDK\VisualStudioIntegration\Common\Assemblies\`.

- El ensamblado DSL, que encontrará en la carpeta bin del proyecto DSL. Su nombre tiene normalmente el siguiente formato: *suempresa*. @No__t_2 *YourProject* .

## <a name="important-classes-in-the-dsl"></a>Clases importantes en DSL
 Antes de poder escribir el código que lee el DSL, debe conocer los nombres de algunas de las clases generadas por el DSL. En la solución DSL, abra el proyecto **DSL** y mire en la carpeta **GeneratedCode** También puede hacer doble clic en el ensamblado DSL en las **referencias**del proyecto y abrir el espacio de nombres dsl en **Examinador de objetos**.

 Estas son las clases que debe identificar:

- *YourDslRootClass* : es el nombre de la clase raíz en el `DslDefinition.dsl`.

- @No__t_1 *sunombrededsl* : esta clase se define en `SerializationHelper.cs` en el proyecto DSL.

- @No__t_1 *sunombrededsl* : esta clase se define en `DomainModel.cs` en el proyecto DSL.

## <a name="reading-from-a-file"></a>Leer de un archivo
 El siguiente ejemplo está diseñado para leer un DSL en el que las clases importantes son las siguientes:

- FamilyTreeModel

- FamilyTreeSerializationHelper

- FamilyTreeDomainModel

  La otra clase de dominio de este DSL es person.

```
using System;
using Microsoft.VisualStudio.Modeling;
using Company.FamilyTree; // Your DSL namespace

namespace StandaloneReadDslConsole
{ class Program
  { static void Main(string[] args)
    {
      // The path of a DSL model file:
      string dslModel = @"C:\FamilyTrees\Tudor.ftree";
      // Set up the Store to read your type of model:
      Store store = new Store(
        typeof(Company.FamilyTree.FamilyTreeDomainModel));
      // The Model type generated by the DSL:
      FamilyTreeModel familyTree;
      // All Store changes must be in a Transaction:
      using (Transaction t =
        store.TransactionManager.BeginTransaction("Load model"))
      {
        familyTree =
           FamilyTreeSerializationHelper.Instance.
              LoadModel(store, dslModel, null, null, null);
        t.Commit(); // Don't forget this!
      }
      // Now we can read the model:
      foreach (Person p in familyTree.People)
      {
        Console.WriteLine(p.Name);
        foreach (Person child in p.Children)
        {
          Console.WriteLine("    " + child.Name);
        }
} } } }
```

## <a name="saving-to-a-file"></a>Guardar en un archivo
 La siguiente adición al código anterior realiza un cambio en el modelo y, a continuación, lo guarda en un archivo.

```
using (Transaction t =
  store.TransactionManager.BeginTransaction("update model"))
{
  // Create a new model element:
  Person p = new Person(store);
  // Set its embedding relationship:
  p.FamilyTreeModel = familyTree;
  // - same as: familyTree.People.Add(p);
  // Set its properties:
  p.Name = "Edward VI";
  t.Commit(); // Don't forget this!
}
// Save the model:
try
{
  SerializationResult result = new SerializationResult();
  FamilyTreeSerializationHelper.Instance
    .SaveModel(result, familyTree, @"C:\FamilyTrees\Tudor-upd.ftree");
  // Report any error:
  if (result.Failed)
  {
    foreach (SerializationMessage message in result)
    {
      Console.WriteLine(message);
    }
  }
}
catch (System.IO.IOException ex)
{ ... }
```
